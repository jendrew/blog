<!DOCTYPE html>
<html lang="pl" layout:decorator="layout/base"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">

<!--TODO: add 'edit post' button next to the title-->

<head prefix=" og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
    <title th:text="${post.title}"></title>
    <link rel="canonical" th:href="${@environment.getProperty('sitemap.base.url')} + '/posts/' + ${post.slug}"/>

    <!--/* FACEBOOK OPEN GRAPH MARKERS */-->
    <meta property="og:app_id" th:content="${@environment.getProperty('facebook.app.id')}" />
    <meta property="og:url" th:content="'https://' + ${#httpServletRequest.getHeader('host')} + '/posts/' + ${post.slug}"/>
    <meta property="og:type" content="article"/>
    <meta property="og:title" th:content="${post.title} + ' | ogarne.to'"/>
    <meta property="og:description" th:content="${post.description}"/>
    <meta th:if="${post.author.fbId != null}"
          property="article.author"
          th:content="${post.author.fbId}"/>
    <meta property="article.publisher" th:content="${@environment.getProperty('facebook.publisher')}"/>
    <meta th:if="${post.imagePaths != null}"
          th:each="path : ${post.imagePaths}"
          property="og:image"
          th:content="${'https://' + #httpServletRequest.getHeader('host')} + ${path}"/>
    <!--/* /FACEBOOK OPEN GRAPH MARKERS  */-->
</head>


<body>
<section layout:fragment="content" class="ob-content">

    <div th:object="${post}">

        <div class="mb-2">
            <a th:href="${#httpServletRequest.getHeader('referer')}">
                <span class="fa fa-chevron-left ob-header-element mr-2" aria-hidden="true"></span>
            </a>
            <h2 th:text="*{#strings.toUpperCase(title)}" class="my-0 ob-header-element">

            </h2>
        </div>



        <div class="ob-post-header ob-color-darkgrey mb-0 aligh">

            <span class="fa fa-calendar-o" aria-hidden="true"></span>
            <span th:text="*{#dates.format(dateCreated, 'dd MMMM yyyy HH:mm')}" class="pr-4"></span>

            <!--/* <span class="fa fa-user-o" aria-hidden="true"></span>
             <span th:text="*{author.username}" class="pr-4"></span> */-->
            <span class="fa fa-folder-open-o" aria-hidden="true"></span>
            <a th:href="@{|/categories/*{category.name}|}"><span th:text="*{category.displayName}"></span></a>
            <a sec:authorize="hasRole('ROLE_ADMIN')" th:href="@{|/admin/posts/*{id}/edit|}" class="pl-4">
                <span class="fa fa-pencil ob-color-darkgrey"></span>
            </a>
        </div>
        <hr class="pb-3"/>
        <p th:utext="*{body}"></p>


    </div>

</section>


</body>
</html>